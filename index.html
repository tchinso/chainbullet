<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>모바일 탄막 슈팅 (세로)</title>
  <style>
    :root{
      --hud-bg: rgba(15,18,25,.55);
      --hud-fg: #e8f0ff;
      --accent: #66d9ef;
      --accent-2:#ffd166;
      --danger:#ff6b6b;
      --ok:#4cd964;
    }
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body { height:100%; margin:0; background:#0b0f13; font-family: system-ui, -apple-system, Segoe UI, Roboto, Apple SD Gothic Neo, Noto Sans, sans-serif; color:#e8f0ff;}
    #app { height:100%; width:100%; display:flex; align-items:center; justify-content:center; }
    /* Safe area container */
    #game-wrap{
      width:100%;
      height:100%;
      max-width: 720px; /* phone portrait comfort */
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      margin:0 auto;
      overflow:hidden;
      background: radial-gradient(120% 120% at 50% -10%, #1a2330 0%, #0b0f13 60%);
    }
    /* 9:16 stage area */
    #stage{
      position:relative;
      width:100%;
      height:100%;
      aspect-ratio: 9 / 16;
      max-height:100%;
      max-width: calc(100vh * 9 / 16);
      margin:auto;
      background:#0b0f13;
      overflow:hidden;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,.45);
    }
    canvas#game{
      position:absolute; inset:0; width:100%; height:100%;
      touch-action:none;
    }
    /* HUD */
    .hud-top{
      position:absolute; top:8px; left:8px; right:8px; display:flex; align-items:center; gap:8px;
    }
    .chip{
      background:var(--hud-bg); color:var(--hud-fg); padding:6px 10px; border-radius:12px; font-size:12px; display:flex; align-items:center; gap:8px; backdrop-filter: blur(6px);
      border:1px solid rgba(255,255,255,.07);
    }
    .chip .buffs{ display:flex; gap:4px; }
    .buff{ width:18px; height:18px; border-radius:50%; border:1px solid rgba(255,255,255,.15); }
    .spacer{ flex:1; }
    .btn{
      background:var(--hud-bg); border:1px solid rgba(255,255,255,.08); color:#fff; padding:8px 12px; border-radius:10px; font-size:13px;
      user-select:none;
    }
    .btn:active{ transform: translateY(1px); }
    /* Bottom HUD */
    .hud-bottom{
      position:absolute; left:0; right:0; bottom:0; padding:12px;
      display:grid; grid-template-columns: 1fr auto 1fr; align-items:end; pointer-events:none;
    }
    /* Character bar */
    #team-bar{
      pointer-events:auto;
      display:flex; gap:8px; justify-content:center; align-items:flex-end;
    }
    .portrait{
      width:64px; height:64px; position:relative; border-radius:50%; overflow:hidden; background:#111; border:2px solid rgba(255,255,255,.12);
      box-shadow: 0 6px 18px rgba(0,0,0,.35);
    }
    .portrait.current{ border-color: var(--accent); box-shadow: 0 0 0 2px rgba(102,217,239,.35), 0 6px 18px rgba(0,0,0,.45); }
    .portrait img{ width:100%; height:100%; object-fit:cover; filter:saturate(1.1) contrast(1.05); }
    .ring{
      position:absolute; inset:-2px; border-radius:50%; border: 3px solid rgba(255,255,255,.14);
      clip-path: polygon(0 0,100% 0,100% 100%,0 100%);
    }
    .gauge{ position:absolute; bottom:-6px; left:10%; width:80%; height:6px; background: rgba(255,255,255,.08); border-radius: 99px; overflow:hidden; }
    .gauge .fill{ height:100%; width:0%; background: linear-gradient(90deg, #00e5ff, #7cffcb); }
    .hpbar{ position:absolute; top:-6px; left:10%; width:80%; height:6px; background: rgba(255,255,255,.08); border-radius: 99px; overflow:hidden; }
    .hpbar .fill{ height:100%; width:100%; background: linear-gradient(90deg, #26de81, #20bf6b); }
    .role{ position:absolute; right:-4px; bottom:-4px; font-size:11px; background: #111; border:1px solid rgba(255,255,255,.2); padding:2px 6px; border-radius:8px; color:#fff; }
    /* Controls */
    #controls{ display:flex; align-items:end; justify-content:space-between; pointer-events:none; }
    #stick-zone{ width:48vw; max-width:300px; height:28vh; max-height:240px; pointer-events:auto; touch-action:none; }
    #buttons{ width:48vw; max-width:300px; height:28vh; max-height:240px; display:flex; gap:14px; justify-content:flex-end; align-items:flex-end; pointer-events:auto; }
    .cbtn{
      width:84px; height:84px; border-radius:50%; background: radial-gradient(120% 120% at 30% 20%, #2a3240, #12161c);
      border:1px solid rgba(255,255,255,.08); box-shadow: 0 10px 24px rgba(0,0,0,.45); position:relative;
      display:flex; align-items:center; justify-content:center; user-select:none;
    }
    .cbtn .label{ font-weight:700; font-size:13px; letter-spacing: .3px; opacity:.85; }
    .cbtn.small{ width:66px; height:66px; }
    .cbtn.glow{ box-shadow: 0 0 16px rgba(255,209,102,.35), inset 0 0 12px rgba(255,209,102,.12); border-color: rgba(255,209,102,.35); }
    /* Virtual stick */
    #stick{
      position:absolute; width:140px; height:140px; border-radius:50%; border:2px solid rgba(255,255,255,.12);
      background:rgba(20,24,32,.35); left:18px; bottom:18px; display:none; pointer-events:none; backdrop-filter: blur(4px);
    }
    #stick .knob{
      position:absolute; width:56px; height:56px; border-radius:50%; background:rgba(102,217,239,.9);
      left:42px; top:42px; transform: translate(0,0); box-shadow: 0 8px 20px rgba(0,0,0,.55);
    }
    /* Screens */
    .screen{
      position:absolute; inset:0; display:none; align-items:center; justify-content:center; background:rgba(4,8,12,.75); backdrop-filter: blur(4px);
      padding:20px;
    }
    .card{
      background: linear-gradient(180deg, rgba(25,30,40,.96), rgba(10,12,16,.96));
      border:1px solid rgba(255,255,255,.08);
      border-radius:16px; padding:16px; width:min(520px, 92%);
      box-shadow: 0 10px 30px rgba(0,0,0,.55);
    }
    .title{ font-size:20px; margin:0 0 12px; }
    .row{ display:flex; gap:10px; flex-wrap:wrap; }
    .pick{
      flex:1 1 calc(33.33% - 10px); min-width:140px;
      background:#121821; border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:12px; cursor:pointer;
    }
    .pick:hover{ outline:2px solid var(--accent); }
    .muted{ opacity:.8; font-size:13px; }
  </style>
</head>
<body>
  <div id="app">
    <div id="game-wrap">
      <div id="stage">
        <canvas id="game"></canvas>

        <!-- Top HUD -->
        <div class="hud-top">
          <div class="chip" id="levelChip">Lv.<span id="lvl">1</span></div>
          <div class="chip">시간 <span id="time">00:00</span></div>
          <div class="chip"><span>버프</span><div class="buffs" id="buffIcons"></div></div>
          <div class="spacer"></div>
          <button class="btn" id="pauseBtn">일시정지</button>
        </div>

        <!-- Bottom HUD -->
        <div class="hud-bottom">
          <!-- Controls -->
          <div id="controls">
            <div id="stick-zone">
              <div id="stick"><div class="knob"></div></div>
            </div>
            <div id="buttons">
              <div id="skillBtn" class="cbtn small"><span class="label">스킬</span></div>
              <div id="attackBtn" class="cbtn"><span class="label">공격</span></div>
            </div>
          </div>
          <!-- Team bar -->
          <div id="team-bar"></div>
        </div>

        <!-- Buff selection -->
        <div class="screen" id="buffScreen">
          <div class="card">
            <h3 class="title">레벨 클리어! 버프를 하나 고르자</h3>
            <div class="row" id="buffChoices"></div>
            <p class="muted" style="margin-top:8px">선택한 버프는 이번 20레벨 러닝에만 적용돼</p>
            <div style="margin-top:10px; text-align:right">
              <button class="btn" id="skipBuffBtn">건너뛰기</button>
            </div>
          </div>
        </div>

        <!-- Pause / Game Over / Victory -->
        <div class="screen" id="pauseScreen">
          <div class="card">
            <h3 class="title">일시정지</h3>
            <div class="row">
              <button class="btn" id="resumeBtn">계속하기</button>
              <button class="btn" id="restartBtn">처음부터</button>
            </div>
          </div>
        </div>

        <div class="screen" id="overScreen">
          <div class="card">
            <h3 class="title">패배…</h3>
            <p>다음엔 버프 조합을 바꿔볼까?</p>
            <div class="row">
              <button class="btn" id="retryBtn">다시 도전</button>
            </div>
          </div>
        </div>

        <div class="screen" id="winScreen">
          <div class="card">
            <h3 class="title">승리!</h3>
            <p>20레벨 보스를 격파했어!</p>
            <div class="row">
              <button class="btn" id="againBtn">새 러닝 시작</button>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
  <script src="game.js"></script>
</body>
</html>
